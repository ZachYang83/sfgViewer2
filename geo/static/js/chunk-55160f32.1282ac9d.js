(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55160f32"],{"1da4":function(e,a,t){},"395d":function(e,a,t){},4789:function(e,a,t){"use strict";t("ff31")},"565e":function(e,a,t){},"5b13":function(e,a,t){"use strict"},7714:function(e,a,t){"use strict";t("1da4")},"86d1":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"map"}},[t("Legend",{staticStyle:{bottom:"20px",left:"10px",width:"200px",height:"auto"},attrs:{title:e.title,items:e.items}}),t("div",{staticClass:"timeLine",on:{changeData:e.changeData}},[t("Timeline",{on:{changeData:e.changeLayer}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showData,expression:"showData"}],staticClass:"dataPan",class:{active:e.showData}},[t("div",{staticClass:"item changzhu"},[e._m(0),t("div",{staticClass:"content"},[t("keep-alive",[t(e.idGongyeyuan,{ref:"shangquan_pan",tag:"component",attrs:{datas:e.liuchuDatas}})],1)],1),t("div",{staticClass:"foot"},[t("div",{staticClass:"foot-item",class:{active:"gyy_pop"==e.idGongyeyuan},on:{click:function(a){e.idGongyeyuan="gyy_pop"}}},[e._v(" 月度人口 ")]),t("div",{staticClass:"foot-item",class:{active:"gyy_hj"==e.idGongyeyuan},on:{click:function(a){e.idGongyeyuan="gyy_hj"}}},[e._v(" 客流人口户籍 ")])])])])],1)},i=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"title"},[t("h2",[e._v("商圈客流")])])}],s=t("8c93"),o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"timeline"}},[t("div",{ref:"timeline-table",staticClass:"timeline-table"})])},l=[],r=t("313e");let u={timeline:{axisType:"category",lineStyle:{show:!0},symbol:"circle",itemStyle:{normal:{color:"rgba(194,53,49, 0.5)"}},controlStyle:{showPrevBtn:!0,showNextBtn:!0,normal:{color:"rgba(194,53,49, 0.5)",borderColor:"rgba(194,53,49, 0.5)"}},orient:"horizontal",inverse:!1,x:0,x2:0,y:0,width:"90%",height:"80%",loop:!1,autoPlay:!1,playInterval:1e3,realtime:!0},baseOption:{tooltip:{trigger:"axis"}}};class c{constructor(){this.chart=void 0,this.lastIndex=0}static makeTimeline(e,a,t){let n=new c,i=a.timeline.data.length,s=r["util"].merge(u,a,!0);s=s||{},n.chart=r["init"](e,null,{}),n.chart.on("timelineChanged",e=>{let a=n.lastIndex,s=e.currentIndex;console.log("last index:"+a+",current index:"+s),0!==i?a!=s?(n.lastIndex=s,console.log("move "+a+" to "+s),t.callback(n,e)):a===s&&(0===a?t.last(n,e):t.next(n,e)):console.log("no data.")}),n.chart.setOption(s)}update(e){let a=r["util"].merge(u,e,!0),t=a.timeline.currentIndex;this.chart.setOption(a),this.lastIndex=void 0!=t?t:0}}var d={name:"Timeline",data(){return{}},mounted:function(){let e=this,a=this.$refs["timeline-table"],t=this,n={timeline:{data:[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210],label:{formatter:function(e){return e}}}},i=[1,20],s={callback:(a,t)=>{let n=t.currentIndex;e.changeData(n)},last:(e,a)=>{let s=a.currentIndex;if(curPage>i[0]){curPage-=1,n.timeline.data=t.getDataJson(start,len,-1);let a=n.timeline.data.length-1;n.timeline.currentIndex=a,e.update(n),start-=len}console.log("-curPage:"+curPage+",curIndex:"+s)},next:(e,a)=>{let s=a.currentIndex;curPage<i[1]&&(curPage+=1,n.timeline.data=t.getDataJson(start,len,1),n.timeline.currentIndex=0,e.update(n),start+=len),console.log("+curPage:"+curPage+",curIndex:"+s)}};c.makeTimeline(a,n,s)},methods:{changeData(e){console.log("子组件");let a=[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210];this.$parent.changeData(a[e])}}},h=d,g=(t("4789"),t("2877")),y=Object(g["a"])(h,o,l,!1,null,"1d31220c",null),m=y.exports,f=t("e624"),p=(t("5b13"),t("b21f")),v=t("b775");function x(e,a){return Object(v["a"])({url:e,method:"get",params:a})}var k=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"gyy_hujiData"}})},b=[];let _;var j={name:"gyy_hj",props:{datas:{type:Object,default:()=>({})}},mounted(){var e=document.getElementById("gyy_hujiData");_=echarts.init(e),this.setChart(this.datas)},methods:{setChart(e){this.$nextTick(()=>{_.resize()});let a=[{key:"北京",value:e.hujidata.beijing},{key:"天津",value:e.hujidata.tianjin},{key:"河北",value:e.hujidata.hebei},{key:"山西",value:e.hujidata.shanxi},{key:"内蒙古",value:e.hujidata.neimenggu},{key:"辽宁",value:e.hujidata.liaoning},{key:"吉林",value:e.hujidata.jilin},{key:"黑龙江",value:e.hujidata.heilongjiang},{key:"上海",value:e.hujidata.shanghai},{key:"江苏",value:e.hujidata.jiangsu},{key:"浙江",value:e.hujidata.zhejiang},{key:"安徽",value:e.hujidata.anhui},{key:"福建",value:e.hujidata.fujian},{key:"江西",value:e.hujidata.jiangxi},{key:"山东",value:e.hujidata.shandong},{key:"河南",value:e.hujidata.henan},{key:"湖北",value:e.hujidata.hubei},{key:"湖南",value:e.hujidata.hunan},{key:"广东",value:e.hujidata.guangdong},{key:"广西",value:e.hujidata.guangxi},{key:"海南",value:e.hujidata.hainan},{key:"重庆",value:e.hujidata.chongqing},{key:"四川",value:e.hujidata.sichuan},{key:"贵州",value:e.hujidata.guizhou},{key:"云南",value:e.hujidata.yunnan},{key:"西藏",value:e.hujidata.xizang},{key:"陕西",value:e.hujidata.shannxi},{key:"甘肃",value:e.hujidata.gansu},{key:"青海",value:e.hujidata.qinghai},{key:"宁夏",value:e.hujidata.ningxia},{key:"新疆",value:e.hujidata.xinjiang}];a.sort((e,a)=>e.value-a.value);let t=[],n=[];a.forEach(e=>{n.push(e.key),t.push(e.value)});let i={tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:10,y2:20},xAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"category",data:n,splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:t,itemStyle:{normal:{label:{show:!0,position:"right",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};_.setOption(i,!0)}}},w=j,F=(t("b949"),Object(g["a"])(w,k,b,!1,null,"71b93b20",null)),D=F.exports,q=function(){var e=this,a=e.$createElement;e._self._c;return e._m(0)},C=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"gyy_pop"}},[t("div",{attrs:{id:"workPop"}}),t("div",{attrs:{id:"liudongPop"}})])}];let S;var I={name:"gyy_pop",props:{datas:{type:Object,default:()=>({})}},mounted(){var e=document.getElementById("workPop");S=echarts.init(e)},methods:{setChart(e){this.$nextTick(()=>{S.resize()});let a=[{key:"1月",value:e.workData[0]},{key:"2月",value:e.workData[1]},{key:"3月",value:e.workData[2]},{key:"4月",value:e.workData[3]},{key:"5月",value:e.workData[4]},{key:"6月",value:e.workData[5]},{key:"7月",value:e.workData[6]},{key:"8月",value:e.workData[7]},{key:"9月",value:e.workData[8]},{key:"10月",value:e.workData[9]}],t=[],n=[];a.forEach(e=>{t.push(e.key),n.push(e.value)});let i={title:{left:"center",text:"月度工作人口",textStyle:{color:"#BDBDBD"}},tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:50,y2:30},yAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}},axisTick:{show:!1}},xAxis:{type:"category",data:t,splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:n,itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};S.setOption(i,!0)}}},L=I,B=(t("8842"),Object(g["a"])(L,q,C,!1,null,"43044934",null)),G=B.exports,A=t("e192"),P=t.n(A);t("ac6d");let R,z;window.mapbox=P.a;var O={data(){return{map:null,showData:!1,idGongyeyuan:"gyy_pop",liuchuDatas:{},title:"客流人口（万人）",items:[{index:1,text:"0 - 10",style:"backgroundColor:RGBA(225,225,225)"},{index:2,text:"10 - 20",style:"backgroundColor:RGBA(224,250,242)"},{index:3,text:"20 - 30",style:"backgroundColor:RGBA(220,240,229)"},{index:4,text:"30 - 50",style:"backgroundColor:RGBA(132,196,214)"},{index:5,text:"50 - 100",style:"backgroundColor:RGBA(50,107,171)"},{index:6,text:"100以上",style:"backgroundColor:RGBA(6,51,154)"}],timeIndex:202201,layerProp:{name:"天河城",busId:356}}},components:{Legend:s["a"],Timeline:m,gyy_hj:D,gyy_pop:G},mounted(){this.initMap(),this.loadWMS(),this.mouseEvent()},methods:{init(){z.getCanvas().style.cursor="pointer",Object(f["a"])(z,[113.35,22.9],6.5)},initMap(){console.log("daffdsa"),P.a.accessToken="pk.eyJ1IjoiemFjaHlhbmc4MyIsImEiOiJja211MjRsbm4waXMwMm5wZDE3d3BuZjBuIn0.lcRS0kbOWjzFw-UikwbyHQ",z=new P.a.Map({container:"map",style:{version:8,glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",sources:{mapsource:{type:"raster",tiles:["https://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}"],tileSize:256}},layers:[{id:"mapsource",type:"raster",source:"mapsource",minzoom:0,maxzoom:18}]},center:[113.35,22.9],attributionControl:!1,zoom:6.5,antialias:!1}),z.getCanvas().style.cursor="pointer"},loadWMS(){z.on("load",(function(){z.addSource("sfg_shangquan",{type:"vector",scheme:"tms",tiles:["https://zwfw.credit.gdgov.cn/geoserver/gwc/service/tms/1.0.0/gpzi%3Asfg_shangquan@EPSG%3A900913@pbf/{z}/{x}/{y}.pbf"]}),z.addLayer({id:"sfg_shangquan",source:"sfg_shangquan","source-layer":"sfg_shangquan",type:"fill",paint:{"fill-outline-color":"#455a64","fill-color":["case",["<",["get","mon1"],10],"RGBA(225,225,225,0.7)",["<",["get","mon1"],20],"RGBA(224,250,242,0.7)",["<",["get","mon1"],30],"RGBA(220,240,229,0.7)",["<",["get","mon1"],50],"RGBA(132,196,214,0.7)",["<",["get","mon1"],100],"RGBA(50,107,171,0.7)","RGBA(6,51,154,0.7)"]}}),z.addLayer({id:"sfg_shangquan_sym",source:"sfg_shangquan","source-layer":"sfg_shangquan",type:"symbol",layout:{"icon-image":"","text-field":"{Name}\n{mon1}","text-size":12,"text-anchor":"top"},paint:{"text-color":"#ffffff"}}),z.addLayer({id:"sfg_shangquan-line",type:"line",source:"sfg_shangquan","source-layer":"sfg_shangquan",paint:{"line-color":"#ff4081","line-width":1}}),z.addLayer({id:"sfg_shangquan-hl",type:"line",source:"sfg_shangquan","source-layer":"sfg_shangquan",paint:{"line-color":"#18ffff","line-width":3},filter:["in","id",""]})}))},changeLayer(e){var a,t;switch(e){case 0:a="mon1",t="{Name}\n{mon1}";break;case 1:a="mon2",t="{Name}\n{mon2}";break;case 2:a="mon3",t="{Name}\n{mon3}";break;case 3:a="mon4",t="{Name}\n{mon4}";break;case 4:a="mon5",t="{Name}\n{mon5}";break;case 5:a="mon6",t="{Name}\n{mon6}";break;case 6:a="mon7",t="{Name}\n{mon7}";break;case 7:a="mon8",t="{Name}\n{mon8}";break;case 8:a="mon9",t="{Name}\n{mon9}";break;case 9:a="mon10",t="{Name}\n{mon10}";break}var n={"fill-outline-color":"#455a64","fill-color":["case",["<",["get",a],10],"RGBA(225,225,225,0.7)",["<",["get",a],20],"RGBA(224,250,242,0.7)",["<",["get",a],30],"RGBA(220,240,229,0.7)",["<",["get",a],50],"RGBA(132,196,214,0.7)",["<",["get",a],100],"RGBA(50,107,171,0.7)","RGBA(6,51,154,0.7)"]},i={"icon-image":"","text-field":t,"text-size":12,"text-anchor":"top"};z.removeLayer("sfg_shangquan"),z.addLayer({id:"sfg_shangquan",source:"sfg_shangquan","source-layer":"sfg_shangquan",type:"fill",paint:n}),z.removeLayer("sfg_gongyeyuan_sym"),z.addLayer({id:"sfg_gongyeyuan_sym",source:"sfg_shangquan","source-layer":"sfg_shangquan",type:"symbol",layout:i}),z.removeLayer("sfg_shangquan-hl"),z.addLayer({id:"sfg_shangquan-hl",source:"sfg_shangquan","source-layer":"sfg_shangquan",type:"line",paint:{"line-color":"#18ffff","line-width":3},filter:["in","id",""]})},mouseEvent(){let e=this;z.on("click",e.getInfo)},getInfo(e){let a=this;var t=z.queryRenderedFeatures(e.point);if("sfg_shangquan"==t[0].layer.id){var n=t[0].properties;R=[n["mon1"],n["mon2"],n["mon3"],n["mon4"],n["mon5"],n["mon6"],n["mon7"],n["mon8"],n["mon9"],n["mon10"]],z.setFilter("sfg_shangquan-hl",["in","id",t[0].properties.id])}a.layerProp={busId:n.id,name:n.name},this.getData()},getData(){let e=this;x("/shengfagai/shangquan-hj/getSqHuji",{busId:e.layerProp.busId,time:e.timeIndex}).then(a=>{e.liuchuDatas={workData:R,hujidata:a.data.data[0]},e.showData=!0,e.$refs["shangquan_pan"].setChart(e.liuchuDatas)})},changeData(e){this.timeIndex=e,this.getData()}},destroyed(){let e=this;Object(p["a"])(z,["sfg_shangquan-hl","sfg_shangquan_sym","sfg_shangquan-line","sfg_shangquan"]),z.off("click",e.getInfo)}},E=O,T=(t("f98a"),Object(g["a"])(E,n,i,!1,null,"1b7b9a08",null));a["default"]=T.exports},8842:function(e,a,t){"use strict";t("ba32")},"8c93":function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{ref:"legendClass",staticClass:"legendClass"},[e.isFold?t("div",{staticClass:"foldState",on:{click:e.unShowData}},[t("span",[e._v(e._s(e.title))])]):t("div",{staticClass:"showState"},[t("div",{staticClass:"head",on:{click:e.unShowData}},[t("span",{staticClass:"title"},[t("span",[e._v(e._s(e.title))])])]),t("div",{staticClass:"body"},[e._l(e.items,(function(a){return[t("li",{key:a.key,staticClass:"legendItem",attrs:{index:a.index}},[t("div",{staticClass:"color",style:a.style}),t("div",{staticClass:"legendText",style:e.legentText},[e._v(e._s(a.text))])])]}))],2)])])},i=[],s={name:"legendClass",props:{title:{default:null},items:{default:Array},legentText:{default:null}},data(){return{isFold:!1}},methods:{unShowData(){this.isFold=!this.isFold}}},o=s,l=(t("7714"),t("2877")),r=Object(l["a"])(o,n,i,!1,null,"1f0ae8ec",null);a["a"]=r.exports},b21f:function(e,a,t){"use strict";function n(e,a){a.forEach(a=>{e.getLayer(a)&&e.removeLayer(a),e.getSource(a)&&e.removeSource(a)})}t.d(a,"a",(function(){return n}))},b775:function(e,a,t){"use strict";var n=t("bc3a"),i=t.n(n),s=t("5c96");const o=i.a.create({baseURL:"https://zwfw.credit.gdgov.cn/yxjc/geo-api/"});o.interceptors.request.use(e=>e,e=>(console.log(e),Promise.reject(e))),o.interceptors.response.use(e=>200===e.status?Promise.resolve(e):Promise.reject(e),e=>(console.log("err"+e),Object(s["Message"])({message:e.message,type:"error",duration:1e4}),Promise.reject(e))),a["a"]=o},b949:function(e,a,t){"use strict";t("395d")},ba32:function(e,a,t){},e624:function(e,a,t){"use strict";function n(e,a,t,n=0){e.setCenter(a),e.setZoom(t),e.setPitch(n)}t.d(a,"a",(function(){return n}))},f98a:function(e,a,t){"use strict";t("565e")},ff31:function(e,a,t){}}]);
//# sourceMappingURL=chunk-55160f32.1282ac9d.js.map