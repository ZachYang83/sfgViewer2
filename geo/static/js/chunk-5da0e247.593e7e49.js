(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5da0e247"],{"1da4":function(e,t,a){},"350e":function(e,t,a){},"5b13":function(e,t,a){"use strict"},7714:function(e,t,a){"use strict";a("1da4")},"7dda":function(e,t,a){"use strict";a("b2f9")},"85d2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"map"}},[a("Legend",{staticStyle:{bottom:"20px",left:"10px",width:"200px",height:"auto"},attrs:{title:e.title,items:e.items}}),a("div",{staticClass:"timeLine"},[a("Timeline",{on:{changeData:e.changeLayer}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showData,expression:"showData"}],staticClass:"dataPan",class:{active:e.showData}},[a("div",{staticClass:"item changzhu"},[e._m(0),a("div",{staticClass:"content"},[a("keep-alive",[a(e.isChangzhu,{ref:"changzhu_pan",tag:"component",attrs:{datas:e.changzhu}})],1)],1)])])],1)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("h2",[e._v("县区常驻人口")])])}],s=a("8c93"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"timeline"}},[a("div",{ref:"timeline-table",staticClass:"timeline-table"})])},r=[],c=a("313e");let l={timeline:{axisType:"category",lineStyle:{show:!0},symbol:"circle",itemStyle:{normal:{color:"rgba(194,53,49, 0.5)"}},controlStyle:{showPrevBtn:!0,showNextBtn:!0,normal:{color:"rgba(194,53,49, 0.5)",borderColor:"rgba(194,53,49, 0.5)"}},orient:"horizontal",inverse:!1,x:0,x2:0,y:0,width:"90%",height:"80%",loop:!1,autoPlay:!1,playInterval:1e3,realtime:!0},baseOption:{tooltip:{trigger:"axis"}}};class u{constructor(){this.chart=void 0,this.lastIndex=0}static makeTimeline(e,t,a){let n=new u,o=t.timeline.data.length,s=c["util"].merge(l,t,!0);s=s||{},n.chart=c["init"](e,null,{}),n.chart.on("timelineChanged",e=>{let t=n.lastIndex,s=e.currentIndex;console.log("last index:"+t+",current index:"+s),0!==o?t!=s?(n.lastIndex=s,console.log("move "+t+" to "+s),a.callback(n,e)):t===s&&(0===t?a.last(n,e):a.next(n,e)):console.log("no data.")}),n.chart.setOption(s)}update(e){let t=c["util"].merge(l,e,!0),a=t.timeline.currentIndex;this.chart.setOption(t),this.lastIndex=void 0!=a?a:0}}var h={name:"Timeline",data(){return{}},mounted:function(){let e=this,t=this.$refs["timeline-table"],a=this,n={timeline:{data:[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210],label:{formatter:function(e){return e}}}},o=[1,20],s={callback:(t,a)=>{let n=a.currentIndex;e.changeData(n)},last:(e,t)=>{let s=t.currentIndex;if(curPage>o[0]){curPage-=1,n.timeline.data=a.getDataJson(start,len,-1);let t=n.timeline.data.length-1;n.timeline.currentIndex=t,e.update(n),start-=len}console.log("-curPage:"+curPage+",curIndex:"+s)},next:(e,t)=>{let s=t.currentIndex;curPage<o[1]&&(curPage+=1,n.timeline.data=a.getDataJson(start,len,1),n.timeline.currentIndex=0,e.update(n),start+=len),console.log("+curPage:"+curPage+",curIndex:"+s)}};u.makeTimeline(t,n,s)},methods:{changeData(e){let t=[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210];this.$parent.changeLayer(e,t[e])}}},g=h,d=(a("ce56"),a("2877")),m=Object(d["a"])(g,i,r,!1,null,"c36cd39c",null),y=m.exports,f=a("e624"),p=(a("5b13"),a("b21f")),b=a("b775");function x(e,t){return Object(b["a"])({url:e,method:"get",params:t})}var v=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},z=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"changzhu"}},[a("div",{attrs:{id:"city_pan"}}),a("div",{attrs:{id:"county_pan"}})])}];let _,w;var F={name:"cz_chart",props:{datas:{type:Object,default:()=>({})}},mounted(){var e=document.getElementById("city_pan");_=echarts.init(e);var t=document.getElementById("county_pan");w=echarts.init(t)},methods:{setChart(e){let t=this;this.$nextTick(()=>{_.resize(),w.resize()});let a=e.shiData;a.sort((e,t)=>e.pop-t.pop);let n=[],o=[];a.forEach(e=>{o.push(e.city),n.push(e.pop)});let s={title:{left:"center",text:"各市"+t.datas.month.toString().slice(-2)+"月县区常驻人口",textStyle:{color:"#BDBDBD"}},tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:30,y2:30},xAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}},axisTick:{show:!1}},yAxis:{type:"category",data:o,splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:n,itemStyle:{normal:{label:{show:!0,position:"right",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};_.setOption(s,!0);let i=e.monthdata,r={title:{left:"center",text:t.datas.county+"各月县区常驻人口",textStyle:{color:"#BDBDBD"}},tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:50,y2:30},yAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}},axisTick:{show:!1}},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月"],splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:i,itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};w.setOption(r,!0)}}},k=F,C=(a("c5fc"),Object(d["a"])(k,v,z,!1,null,"2f503de6",null)),S=C.exports,L=a("e192"),D=a.n(L);a("ac6d");let I,P;var j={data(){return{layerProp:{city:"广州",month:202201,county:""},changzhu:{},showData:!1,isChangzhu:"Chart",title:"县区常驻人口（万人）",items:[{index:1,text:"0 - 25",style:"backgroundColor:rgb(255,247,242)"},{index:2,text:"25 - 50",style:"backgroundColor:rgb(252,206,202)"},{index:3,text:"50 - 100",style:"backgroundColor:rgb(250,150,178)"},{index:4,text:"100 - 250",style:"backgroundColor:rgb(227,64,153)"},{index:5,text:"250 - 500",style:"backgroundColor:rgb(153,0,122)"}]}},components:{Legend:s["a"],Timeline:y,Chart:S},mounted(){this.initMap(),this.loadWMS(),this.mouseEvent()},methods:{init(){P.getCanvas().style.cursor="pointer",Object(f["a"])(P,[113.35,22.9],6.5)},initMap(){console.log("daffdsa"),D.a.accessToken="pk.eyJ1IjoiemFjaHlhbmc4MyIsImEiOiJja211MjRsbm4waXMwMm5wZDE3d3BuZjBuIn0.lcRS0kbOWjzFw-UikwbyHQ",P=new D.a.Map({container:"map",style:{version:8,glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",sources:{mapsource:{type:"raster",tiles:["https://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}"],tileSize:256}},layers:[{id:"mapsource",type:"raster",source:"mapsource",minzoom:0,maxzoom:18}]},center:[113.35,22.9],attributionControl:!1,zoom:6.5,antialias:!1}),P.getCanvas().style.cursor="pointer"},loadWMS(){P.on("load",(function(){P.addSource("sfg_changzhu",{type:"vector",scheme:"tms",tiles:["https://zwfw.credit.gdgov.cn/geoserver/gwc/service/tms/1.0.0/gpzi%3Asfg_changzhu@EPSG%3A900913@pbf/{z}/{x}/{y}.pbf"]}),P.addLayer({id:"sfg_changzhu",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"fill",paint:{"fill-outline-color":"#455a64","fill-color":["case",["<",["get","1mon"],25],"rgb(255,247,242)",["<",["get","1mon"],50],"rgb(252,206,202)",["<",["get","1mon"],100],"rgb(250,150,178)",["<",["get","1mon"],250],"rgb(227,64,153)",["<",["get","1mon"],500],"rgb(153,0,122)","rgb(73,0,107)"]}}),P.addLayer({id:"sfg_changzhu_sym",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"symbol",layout:{"icon-image":"","text-field":"{county}\n{1mon}","text-size":12,"text-anchor":"top"}}),P.addLayer({id:"sfg_changzhu-hl",type:"line",source:"sfg_changzhu","source-layer":"sfg_changzhu",paint:{"line-color":"#18ffff","line-width":3},filter:["in","county",""]})}))},changeLayer(e,t){var a,n;switch(e){case 0:a="1mon",n="{county}\n{1mon}";break;case 1:a="2mon",n="{county}\n{2mon}";break;case 2:a="3mon",n="{county}\n{3mon}";break;case 3:a="4mon",n="{county}\n{4mon}";break;case 4:a="5mon",n="{county}\n{5mon}";break;case 5:a="6mon",n="{county}\n{6mon}";break;case 6:a="7mon",n="{county}\n{7mon}";break;case 7:a="8mon",n="{county}\n{8mon}";break;case 8:a="9mon",n="{county}\n{9mon}";break;case 9:a="10mon",n="{county}\n{10mon}";break}var o={"fill-outline-color":"#455a64","fill-color":["case",["<",["get",a],25],"rgb(255,247,242)",["<",["get",a],50],"rgb(252,206,202)",["<",["get",a],100],"rgb(250,150,178)",["<",["get",a],250],"rgb(227,64,153)",["<",["get",a],500],"rgb(153,0,122)","rgb(73,0,107)"]},s={"icon-image":"","text-field":n,"text-size":12,"text-anchor":"top"};P.removeLayer("sfg_changzhu"),P.addLayer({id:"sfg_changzhu",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"fill",paint:o}),P.removeLayer("sfg_changzhu_sym"),P.addLayer({id:"sfg_changzhu_sym",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"symbol",layout:s}),P.removeLayer("sfg_changzhu-hl"),P.addLayer({id:"sfg_changzhu-hl",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"line",paint:{"line-color":"#18ffff","line-width":3},filter:["in","county",""]}),this.layerProp.month=t,this.getData()},mouseEvent(){let e=this;P.on("click",e.getInfo)},getInfo(e){let t=this;var a=P.queryRenderedFeatures(e.point);if("sfg_changzhu"==a[0].layer.id){var n=a[0].properties;I=[n["1mon"],n["2mon"],n["3mon"],n["4mon"],n["5mon"],n["6mon"],n["7mon"],n["8mon"],n["9mon"],n["10mon"]],t.changzhu.monthdata=I,P.setFilter("sfg_changzhu-hl",["in","county",a[0].properties.county])}t.layerProp.city=n.city,t.layerProp.county=n.county,this.getData()},getData(){let e=this;x("/shengfagai/changzhu-shi/getChangzhu",{month:e.layerProp.month}).then(t=>{e.changzhu.shiData=t.data.data,e.changzhu.month=e.layerProp.month,e.changzhu.county=e.layerProp.county,e.showData=!0,e.$refs["changzhu_pan"].setChart(e.changzhu)})}},destroyed(){let e=this;Object(p["a"])(P,["sfg_changzhu-hl","sfg_changzhu_sym","sfg_changzhu"]),P.off("click",e.getInfo)}},O=j,E=(a("7dda"),Object(d["a"])(O,n,o,!1,null,"e5b7ac9e",null));t["default"]=E.exports},"8c93":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"legendClass",staticClass:"legendClass"},[e.isFold?a("div",{staticClass:"foldState",on:{click:e.unShowData}},[a("span",[e._v(e._s(e.title))])]):a("div",{staticClass:"showState"},[a("div",{staticClass:"head",on:{click:e.unShowData}},[a("span",{staticClass:"title"},[a("span",[e._v(e._s(e.title))])])]),a("div",{staticClass:"body"},[e._l(e.items,(function(t){return[a("li",{key:t.key,staticClass:"legendItem",attrs:{index:t.index}},[a("div",{staticClass:"color",style:t.style}),a("div",{staticClass:"legendText",style:e.legentText},[e._v(e._s(t.text))])])]}))],2)])])},o=[],s={name:"legendClass",props:{title:{default:null},items:{default:Array},legentText:{default:null}},data(){return{isFold:!1}},methods:{unShowData(){this.isFold=!this.isFold}}},i=s,r=(a("7714"),a("2877")),c=Object(r["a"])(i,n,o,!1,null,"1f0ae8ec",null);t["a"]=c.exports},b21f:function(e,t,a){"use strict";function n(e,t){t.forEach(t=>{e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t)})}a.d(t,"a",(function(){return n}))},b2f9:function(e,t,a){},b775:function(e,t,a){"use strict";var n=a("bc3a"),o=a.n(n),s=a("5c96");const i=o.a.create({baseURL:"https://zwfw.credit.gdgov.cn/yxjc/geo-api/"});i.interceptors.request.use(e=>e,e=>(console.log(e),Promise.reject(e))),i.interceptors.response.use(e=>200===e.status?Promise.resolve(e):Promise.reject(e),e=>(console.log("err"+e),Object(s["Message"])({message:e.message,type:"error",duration:1e4}),Promise.reject(e))),t["a"]=i},b9aa:function(e,t,a){},c5fc:function(e,t,a){"use strict";a("350e")},ce56:function(e,t,a){"use strict";a("b9aa")},e624:function(e,t,a){"use strict";function n(e,t,a,n=0){e.setCenter(t),e.setZoom(a),e.setPitch(n)}a.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=chunk-5da0e247.593e7e49.js.map